<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QM: Working with States</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="ql-awesome.css" rel="stylesheet" type="text/css"/>
<link href="qm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectlogo">
    <a href="https://www.state-machine.com" title="Quantum Leaps"><img alt="Logo" src="logo_ql.png"/></a>
  </div>
   <div id="projectname">
    <doxygen-awesome-dark-mode-toggle id="dark-mode-toggle" title="Toggle Light/Dark Mode"></doxygen-awesome-dark-mode-toggle>
    QM
    &nbsp;<span id="projectnumber">5.1.3</span>
   </div>
   <div id="projectbrief">Model-Based Design Tool</div>
   <div style="padding: 0.5em;">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('sm_state.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Working with States </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sm_state_add">Adding a State</a></li>
<li class="level1"><a href="#sm_state_nest">Nesting of States</a></li>
<li class="level1"><a href="#sm_state_move">Moving a State</a></li>
<li class="level1"><a href="#sm_state_resize">Resizing a State</a></li>
<li class="level1"><a href="#sm_state_delete">Deleting a State</a></li>
<li class="level1"><a href="#sm_state_prop">State Property Sheet</a><ul><li class="level2"><a href="#sm_state-name">State Name</a></li>
<li class="level2"><a href="#sm_state-super">Superstate</a></li>
<li class="level2"><a href="#sm_state-doc">State Documentation</a></li>
<li class="level2"><a href="#sm_state-entry">State Entry Action</a></li>
<li class="level2"><a href="#sm_state-exit">State Exit Action</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p >The concept of <b>State</b> is a very effective mechanism of decomposing event-driven behavior. <em>States</em> divide the overall behavior of a class into separate parts, each part (state) handling events in a specific way. Any change in handling of any event requires a change of state, that is, a state <a class="el" href="sm_tran.html">transition</a>. States are represented in UML as rounded-corner rectangles with the state name at the top. </p>
<div style="clear:both;"></div><h1><a class="anchor" id="sm_state_add"></a>
Adding a State</h1>
<dl class="section note"><dt>Note</dt><dd>In order to add states, you first need to <a class="el" href="sm_statechart.html#sm_add">create</a> and <a class="el" href="bm_diagram.html#bm_diagram_open">show</a> a state diagram. Also, to add, move, resize, or edit states, the State Machine diagram must be <a class="el" href="bm_lock.html">unlocked</a> (<span class="img unlock"></span>).</dd></dl>
<p>Make sure that the State Machine subwindow is active. In the <a class="el" href="sm.html#sm_toolbox">State Machine Toolbox</a> click on the <span class="img state">State</span> tool and <em>release</em> the mouse button (don't drag the tool off the toolbar). At this point, when you hover the mouse over the active state diagram, the mouse pointer changes shape to the <span class="img cur_state1">state</span> tool. To add a state, move the mouse to the desired location of the <b>top-left corner</b> of the state shape and press the left mouse button. At this point you create a state shape of minimal size at the mouse position. You can release the mouse button immediately or you can <b>drag</b> the mouse to the desired location of the <b>bottom-right</b> corner of the state shape. In any case, you can <a class="el" href="sm_state.html#sm_state_resize">resize</a> the state shape at any later time.</p>
<div class="image">
<img src="sm_state-add.gif" alt=""/>
<div class="caption">
Adding a State</div></div>
<h1><a class="anchor" id="sm_state_nest"></a>
Nesting of States</h1>
<p >One of the most important features of <a href="https://www.state-machine.com/fsm/#HSM" class="extern" target="_blank">Hierarchical State Machines (HSMs)</a> (UML Statecharts) is that states can <b>nest</b> within other states, thus forming state hierarchies. In fact, QM&trade; has been specifically designed for ease of working with such hierarchically nested states.</p>
<p >QM&trade; determines state nesting by the <b>geometric</b> arrangement of states in the diagram, whereas state nesting is determined only by the position of the <span>top-left corner</span> of the state rectangle. This state hierarchy is immediately reflected in the <a class="el" href="bm_model.html">hierarchical model view</a> in the <a class="el" href="ui_explorer.html">Model Explorer</a> dock window.</p>
<dl class="section note"><dt>Note</dt><dd>The rule of using just the top-left corner to determine state nesting (as opposed to complete enclosure of one state by another) turns out to be more useful in practice, because it leads to fewer inadvertent changes in state nesting when states are rearranged during diagram editing.</dd></dl>
<div class="image">
<img src="sm_state_nest.png" alt=""/>
<div class="caption">
Example of Nested States</div></div>
<p >For example, the screen shot above shows <code>state2</code> nested in <code>state1</code>, as identified clearly in the <a class="el" href="ui_explorer.html">Model Explorer</a> on the left of the picture. Please note that only the upper-left corner of <code>state2</code> is inside <code>state1</code>, instead of being entirely enclosed by <code>state1</code>. On the other hand, state <code>state3</code> nests entirely inside <code>state2</code>, and indirectly in <code>state1</code> as well.</p>
<dl class="section note"><dt>Note</dt><dd>The state nesting is also reflected in the <a class="el" href="sm_state.html#sm_state-super">Superstate</a> property in the State Property Sheet.</dd></dl>
<h1><a class="anchor" id="sm_state_move"></a>
Moving a State</h1>
<p >To move a state, hover the mouse over the state until you get the move cursor. Click the mouse and drag the state shape to the desired location.</p>
<div class="image">
<img src="sm_state-move.gif" alt=""/>
<div class="caption">
Moving a State</div></div>
<h1><a class="anchor" id="sm_state_resize"></a>
Resizing a State</h1>
<p >You can resize all four edges of a state shape. The top and bottom edges can be resized up and down, while left and right edges can be resized left and right. Additionally, the right-bottom corner can be resized diagonally (i.e., both horizontally and vertically).</p>
<p >To resize the desired edge of a state, hover the mouse over the state edge until you get the resize cursor. Click the mouse and drag the state edge to the desired location.</p>
<div class="image">
<img src="sm_state-resize.gif" alt=""/>
<div class="caption">
Resizing a State</div></div>
<dl class="section note"><dt>Note</dt><dd>The state shape cannot be made smaller than the <a class="el" href="sm_state.html#sm_state-entry">entry box</a> and <a class="el" href="sm_state.html#sm_state-exit">exit box</a> in the state.</dd></dl>
<h1><a class="anchor" id="sm_state_delete"></a>
Deleting a State</h1>
<p >To delete a state, you need to select it as the <a class="el" href="ui_curr_item.html">Current Item</a>, either by clicking on it in the state diagram or in the <a class="el" href="ui_explorer.html">Model Explorer</a>. After this, you can delete the state in several ways: (1) click the <span class="img delete">button</span> in the <a class="el" href="ui_explorer.html#ui_explorer_delete">Explorer Toolbar</a>; (2) press the <span class="button">Del</span> keyboard shortcut; or (3) right-click on the state diagram and choose the <span class="menu">Delete item</span> option from the pop-up menu (see the screen animation below).</p>
<div class="image">
<img src="sm_state-del.gif" alt=""/>
<div class="caption">
Deleting a State</div></div>
<dl class="section note"><dt>Note</dt><dd>Deleting a state is <b>not recursive</b>, meaning that any substates nested within the deleted state are <b>not</b> deleted.</dd></dl>
<h1><a class="anchor" id="sm_state_prop"></a>
State Property Sheet</h1>
<p ><span class="img state">State</span> item can be configured by the State-Specific <a class="el" href="ui_prop.html">Property Sheet</a>.</p>
<div class="image">
<img src="sm_state_prop.png" alt=""/>
<div class="caption">
State Property Sheet</div></div>
<p >The state-item property sheet contains the following properties:</p>
<ul>
<li><a class="el" href="sm_state.html#sm_state-name">State Name</a></li>
<li><a class="el" href="sm_state.html#sm_state-super">Superstate</a> (not editable; see <a class="el" href="sm_state.html#sm_state_nest">Nesting of States</a>)</li>
<li><a class="el" href="sm_state.html#sm_state-doc">State Documentation</a></li>
<li><a class="el" href="sm_state.html#sm_state-entry">State Entry Action</a></li>
<li><a class="el" href="sm_state.html#sm_state-exit">State Exit Action</a></li>
</ul>
<h2><a class="anchor" id="sm_state-name"></a>
State Name</h2>
<p >The state <b>name</b> should be a valid function name in C or C++. Typically, you should strive for a short and punchy name that captures the nature of the state. For example, a state in which a system remains on could be named <code>on</code>. To keep with the naming conventions used in <a class="el" href="gs_examples.html">QM examples</a>, it is recommended to name use lower-case names of states.</p>
<h2><a class="anchor" id="sm_state-super"></a>
Superstate</h2>
<p >The <b>superstate</b> property is not directly editable in the State Property Sheet, because the superstate of the given state is determined <a class="el" href="sm_state.html#sm_state_nest">geometrically</a>.</p>
<dl class="section note"><dt>Note</dt><dd>If a state is placed directly on the drawing canvas and does not nest in any other state, the <em>superstate</em> property shows "top", which is the implicit <b>top-most state</b> that encloses all states in the diagram and is the ultimate root of the state hierarchy.</dd></dl>
<h2><a class="anchor" id="sm_state-doc"></a>
State Documentation</h2>
<p >The <b>documentation</b> entry in the State Property Sheet allows you to provide documentation to the state. The QM code generator parses the documentation entry and can <a class="el" href="ce_comment.html#ce_comment-doc">generate comments</a> from it in the auto-generated code.</p>
<h2><a class="anchor" id="sm_state-entry"></a>
State Entry Action</h2>
<p >A state can have optional <b>entry action</b>. You provide this action in the <a class="el" href="sm_state.html#sm_state_prop">State Property Sheet</a> (see also the screen shot below). If defined, the entry action shows up in the upper-left corner of the state shape.</p>
<p >An entry action is considered defined if the corresponding <b>pseudocode</b> or <b>code</b> entries in the <a class="el" href="sm_state.html#sm_state_prop">State Property Sheet</a> are not empty. Once an entry action is defined the state shape shows the <b>entry box</b> in the upper-left corner just below the name compartment.</p>
<dl class="section note"><dt>Note</dt><dd>The <b>pseudocode</b> property is designed to avoid clutter in the diagram by minimizing the amount of text to display inside the state shape in the diagram. <b>Pseudocode</b> is intended only for displaying in the diagram and has <span>no implications for code generation</span>.</dd></dl>
<p>The actual algorithm QM uses to display action text in the entry box is as follows: If both the <em>pseudocode</em> and <em>code</em> entries in the State Property Sheet are empty, the corresponding entry action is considered undefined and is <b>not displayed</b> at all in the state shape. If the pseduocode entry is not empty, regardless of the contents of the code entry, the <em>pseudocode</em> is displayed in the <b>same line</b> as the <code>e/</code> (<b>e</b>ntry) text. Finally, if the <em>pseudocode</em> is empty, but the <em>code</em> entry is not empty, the <em>code</em> is displayed in the entry text box of the state shape, however, the actual <em>code</em> is displayed in a line <b>below</b> the <code>e/</code> text. Of course, to see the text, you need to expand the entry text box in the state shape.</p>
<div class="image">
<img src="sm_state-entry.gif" alt=""/>
<div class="caption">
Resizing the State Entry Box</div></div>
<p >Once the state shape is <em>selected</em> as the <a class="el" href="ui_curr_item.html">Current Item</a>, you can <b>resize the entry box</b> by dragging the lower-right handle of the box (see the screen animation above).</p>
<h2><a class="anchor" id="sm_state-exit"></a>
State Exit Action</h2>
<p >A state can have optional <b>exit action</b>. You provide this action in the <a class="el" href="sm_state.html#sm_state_prop">State Property Sheet</a> (see also the screen shot below). If defined, the exit action shows up just below the entry action (if defined) in the upper-left corner of the state shape.</p>
<p >An exit action is considered defined if the corresponding <b>pseudocode</b> or <b>code</b> entries in the <a class="el" href="sm_state.html#sm_state_prop">State Property Sheet</a> are not empty. Once an exit action is defined the state shape shows the <b>exit box</b> in the upper-left corner just below the entry action.</p>
<dl class="section attention"><dt>Attention</dt><dd>The <b>pseudocode</b> property is designed to avoid clutter in the diagram by minimizing the amount of text to display inside the state shape. <b>Pseudocode</b> is intended only for displaying in the diagram and has <b>no implications</b> for code generation. Only the <b>Code</b> entry of the <em>exit</em> property matters for code generation.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The actual algorithm QM uses to display action text in the exit box is as follows: If both the <em>pseudocode</em> and <em>code</em> entries in the State Property Sheet are empty, the corresponding exit action is considered undefined and is <b>not displayed</b> at all in the state shape. If the <em>pseduocode</em> entry is not empty, regardless of the contents of the <em>code</em> entry, the pseudocode is displayed in the <b>same line</b> as the <code>x/</code> (e<b>x</b>it) text. Finally, if the <em>pseudocode</em> is empty, but the <em>code</em> entry is not empty, the code is displayed in the exit text box of the state shape, however, the actual code is displayed in a line <b>below</b> the <code>x/</code> text. Of course, to see the text, you need to expand the exit text box in the state shape.</dd></dl>
<div class="image">
<img src="sm_state-exit.gif" alt=""/>
<div class="caption">
Resizing the State Exit Box</div></div>
<p >Once the state shape is <em>selected</em> as the <a class="el" href="ui_curr_item.html">Current Item</a>, you can <b>resize the exit box</b> by dragging the lower-right handle of the box (see the screen animation above).</p>
<hr  />
<p><b>Next:</b> <a class="el" href="sm_tran.html">Working with Transitions</a></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2021 Quantum Leaps</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QM 5.1.3</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QM 5.1.3</b>
</small></address>
    </li>
  </ul>
</div>
</body>
</html>
