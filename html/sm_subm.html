<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QM: Working with Submachine Diagrams</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="ql-awesome.css" rel="stylesheet" type="text/css"/>
<link href="qm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectlogo">
    <a href="https://www.state-machine.com" title="Quantum Leaps"><img alt="Logo" src="logo_ql.png"/></a>
  </div>
   <div id="projectname">
    <doxygen-awesome-dark-mode-toggle id="dark-mode-toggle" title="Toggle Light/Dark Mode"></doxygen-awesome-dark-mode-toggle>
    QM
    &nbsp;<span id="projectnumber">5.1.3</span>
   </div>
   <div id="projectbrief">Model-Based Design Tool</div>
   <div style="padding: 0.5em;">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('sm_subm.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Working with Submachine Diagrams </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sm_subm_add_blank">Adding a Blank Submachine Diagram</a></li>
<li class="level1"><a href="#sm_subm_add_state">Creating a Submachine Diagram from State</a></li>
<li class="level1"><a href="#sm_subm_resize">Resizing a Submachine Diagram</a></li>
<li class="level1"><a href="#sm_subm_delete">Deleting a Submachine Diagram</a></li>
<li class="level1"><a href="#sm_subm_prop">Submachine Diagram Property Sheet</a><ul><li class="level2"><a href="#sm_subm-name">Submachine Name</a></li>
<li class="level2"><a href="#sm_subm-doc">Submachine Documentation</a></li>
<li class="level2"><a href="#sm_subm-entry">Submachine Entry Action</a></li>
<li class="level2"><a href="#sm_subm-exit">Submachine Exit Action</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p ><span class="img submachine">Submachine Diagram</span> allows you to specify a composite state and all its nested substates and transitions (<em>submachine</em>) in such a way that it can be instantiated (and thus reused), possibly <b>multiple times</b>, in the context of a given state machine. You can think of submachines as "macros" or "procedures" that capture common behavior inside a given state machine in order to reuse it (as <a class="el" href="sm_smstate.html">submachine states</a>) within the context of the same state machines </p>
<dl class="section remark"><dt>Remarks</dt><dd>Some designers try to use <em>Submachines</em> as <a href="https://en.wikipedia.org/wiki/UML_state_machine#Orthogonal_regions">"orthogonal regions"</a>. This is <b>incorrect</b>, because <em>Submachines</em> and their instances (<a class="el" href="sm_smstate.html">Submachine States</a>) are <b>not</b> concurrently-active parts. A state machine with multiple <em>Submachine States</em> can still be in only <b>one</b> currently active state configuration ("exclusive-OR"-decomposition).</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If you are looking for partitioning your behavior into concurrently active components ("orthogonal components" with <a href="https://en.wikipedia.org/wiki/UML_state_machine#Orthogonal_regions">AND-decomposition</a>), you should consider the <a href="https://www.state-machine.com/doc/Pattern_Orthogonal.pdf"><b>Orthogonal Component State Pattern</b></a> instead <em>Submachines</em> and <em>Submachine States</em>.</dd></dl>
<p>To enable reuse of a <em>Submachine Diagram</em> without revealing its internal structure ("black-box"), the <em>Submachine Diagram</em> must provide a well-defined interface on its boundary, which consists of <span class="img ep_seg"></span> <a class="el" href="sm_epseg.html">Entry Points</a> for attaching any incoming transitions targeting specific substates and <span class="img xp"></span> <a class="el" href="sm_xp.html">eXit Points</a> for attaching outgoing transitions originating in specific substates.</p>
<div class="image">
<img src="sm_subm.png" alt=""/>
<div class="caption">
Submachine Diagram</div></div>
<dl class="section attention"><dt>Attention</dt><dd>The <a class="el" href="ce.html">QM code generator</a> supports Submachine Diagrams only for the <a class="el" href="sm.html#sm_class_qmsm">QMsm-style state machine implementation strategy</a>. This means that the class to which you add Submachine Diagram must be a subclass of <a class="el" href="sm.html#sm_class">QMsm or QMActive base classes</a>.</dd></dl>
<div style="clear:both;"></div><h1><a class="anchor" id="sm_subm_add_blank"></a>
Adding a Blank Submachine Diagram</h1>
<p >To add an new, blank Submachine Diagram, in the <a class="el" href="ui_explorer.html">Model Explorer</a> <b>right-click</b> on the <a class="el" href="sm_statechart.html#sm_add">State Machine (SM)</a> to which you want to add the Submachine Diagram and select <span class="img submachine">Add Sub-Machine</span> from the popup menu.</p>
<div class="image">
<img src="sm_subm_add.png" alt=""/>
<div class="caption">
Adding a Submachine to a given State Machine diagram</div></div>
<dl class="section note"><dt>Note</dt><dd>In order to add a Submachine Diagram, the State Machine must be <a class="el" href="bm_lock.html">unlocked</a> (<span class="img unlock"></span>).</dd></dl>
<h1><a class="anchor" id="sm_subm_add_state"></a>
Creating a Submachine Diagram from State</h1>
<p >Alternatively, you can create a <em>Submchine Diagram</em> from an existing (composite) state. The advantage of this method is that the created Submachine will contain all the internals of the chosen composite state, including the entry actions, exit action, initial transition, as well as all the nested substates and transitions.</p>
<p >To create a new Submachine Diagram from a given state <b>right-click</b> on this state in the diagram (or in the <a class="el" href="ui_explorer.html">Model Explorer</a>) and select <span class="img submachine">Add Sub-Machine from State</span> from the popup menu.</p>
<div class="image">
<img src="sm_subm_from_state.png" alt=""/>
<div class="caption">
Creating a Submachine from a Composite State</div></div>
<h1><a class="anchor" id="sm_subm_resize"></a>
Resizing a Submachine Diagram</h1>
<p >As all diagrams in QM, the <em>Submachine Diagram</em> has a <a class="el" href="bm_diagram.html#bm_diagram_canvas">Drawing Canvas</a>, which can be resized by dragging the outside edges or the bottom-right corner of the diagram. However, the special feature of <em>Submachine Diagram</em> is that resizing the canvas always simultaneously resizes the outline of the composite state (shown in green).</p>
<div class="image">
<img src="sm_subm_resize.png" alt=""/>
<div class="caption">
Resizing a Submachine Diagram</div></div>
<h1><a class="anchor" id="sm_subm_delete"></a>
Deleting a Submachine Diagram</h1>
<p >To delete a Submachine Diagram, you need to select it as the <a class="el" href="ui_curr_item.html">Current Item</a>, either by clicking on the (green) state outline or in the <a class="el" href="ui_explorer.html">Model Explorer</a>. After this, you can delete the Submachine in several ways: (1) click the <span class="img delete">button</span> in the <a class="el" href="ui_explorer.html#ui_explorer_delete">Explorer Toolbar</a>; (2) press the <span class="button">Del</span> keyboard shortcut; or (3) right-click on the state diagram and choose the <span class="menu">Delete item</span> option from the pop-up menu (see the screen animation below).</p>
<dl class="section note"><dt>Note</dt><dd>Deleting a <em>Submachine Diagram</em> removes the reference to this <em>Submachine</em> in all <a class="el" href="sm_smstate.html">Submachine States</a> based on this Submachine.</dd></dl>
<h1><a class="anchor" id="sm_subm_prop"></a>
Submachine Diagram Property Sheet</h1>
<p ><span class="img state">Submachine Diagram</span> item can be configured by the State-Specific <a class="el" href="ui_prop.html">Property Sheet</a>.</p>
<div class="image">
<img src="sm_subm_prop.png" alt=""/>
<div class="caption">
State Property Sheet</div></div>
<p >The state-item property sheet contains the following properties:</p>
<ul>
<li><a class="el" href="sm_subm.html#sm_subm-name">Submachine Name</a></li>
<li><a class="el" href="sm_subm.html#sm_subm-doc">Submachine Documentation</a></li>
<li><a class="el" href="sm_subm.html#sm_subm-entry">Submachine Entry Action</a></li>
<li><a class="el" href="sm_subm.html#sm_subm-exit">Submachine Exit Action</a></li>
</ul>
<h2><a class="anchor" id="sm_subm-name"></a>
Submachine Name</h2>
<p >The submachine <b>name</b> should be a valid function name in C or C++. Typically, you should strive for a short and punchy name that captures the nature of the submachine. For example, a submachine in which a system remains "on" could be named <code>on</code>. To keep with the naming conventions used in <a class="el" href="gs_examples.html">QM examples</a>, it is recommended to name use lower-case names of submachines.</p>
<h2><a class="anchor" id="sm_subm-doc"></a>
Submachine Documentation</h2>
<p >The <b>documentation</b> entry in the Submachine Property Sheet allows you to provide documentation to the submachine. The QM code generator parses the documentation text and can <a class="el" href="ce_comment.html#ce_comment-doc">generate comments</a> from it in the auto-generated code.</p>
<h2><a class="anchor" id="sm_subm-entry"></a>
Submachine Entry Action</h2>
<p >A submachine can have optional <b>entry action</b>. You provide this action in the <a class="el" href="sm_subm.html#sm_subm_prop">Submachine Property Sheet</a> (see also the screen shot above). If defined, the entry action shows up in the upper-left corner of the submachine outline. The Submachine entry action behaves in exactly the same way as the <a class="el" href="sm_state.html#sm_state-entry">entry action to a state</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Once the state shape is <em>selected</em> as the <a class="el" href="ui_curr_item.html">Current Item</a>, you can <b>resize the entry box</b> by dragging the lower-right handle of the box.</dd></dl>
<h2><a class="anchor" id="sm_subm-exit"></a>
Submachine Exit Action</h2>
<p >A submachine can have optional <b>exit action</b>. You provide this action in the <a class="el" href="sm_subm.html#sm_subm_prop">Submachine Property Sheet</a> (see also the screen shot above). If defined, the exit action shows up in the upper-left corner of the submachine outline (below the entry action, if present). The Submachine exit action behaves in exactly the same way as the <a class="el" href="sm_state.html#sm_state-exit">exit action to a state</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Once the state shape is <em>selected</em> as the <a class="el" href="ui_curr_item.html">Current Item</a>, you can <b>resize the exit box</b> by dragging the lower-right handle of the box.</dd></dl>
<hr  />
<p><b>Next:</b> <a class="el" href="sm_epseg.html">Working with Entry-Point Segments</a></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; 2005-2021 Quantum Leaps</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QM 5.1.3</b>
<hr class="footer"/><address class="footer"><small>
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QM 5.1.3</b>
</small></address>
    </li>
  </ul>
</div>
</body>
</html>
